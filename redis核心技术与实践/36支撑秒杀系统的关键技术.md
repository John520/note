## 秒杀系统特点
* 瞬间并发特别高
* 读多写少

## 如何应对？
* 商品页面元素静态化，然后使用CDN或浏览器将这些静态资源缓存
* 请求的拦截（拦截恶意、抢单脚本）和流控，或**分段放行**（如每100ms 放100个请求，其他拒绝）
* 库存信息放redis, 不要设置过期时间
* redis 扣减库存
* 消息队列处理订单
* 异常订单进行重试

## redis 如何扣减库存
* 分布式锁
* lua脚本 保证原子性

## 是否可以分片保存库存
* 分片可以减少并发（优点）
* 分布式库存查询复杂度变高（缺点，需要多个分片聚合查询）
* 请求分发规则（缺点，要确保流量分发均匀，不然会导致，其他分片还有库存，但是用户却无法购买，前端不展示库存）